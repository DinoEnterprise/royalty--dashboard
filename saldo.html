<!DOCTYPE html>
<html>
<head>
<title>Saldo</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>

<h2 id="nama">Loading...</h2>
<h1 id="saldo"></h1>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyB9MY2lUOPzzoMUlhu1WHv4a6gwFk9PTsY",
  authDomain: "dynopay-1c22b.firebaseapp.com",
  projectId: "dynopay-1c22b"
};

if (!firebase.apps.length) {
  firebase.initializeApp(firebaseConfig);
}

const db = firebase.firestore();

firebase.auth().onAuthStateChanged(user=>{
  if(!user){
    window.location.href="index.html";
  } else {
    db.collection("users").doc(user.uid).get()
      .then(doc=>{
        if(!doc.exists){
          document.getElementById("nama").innerText = "Data belum ada";
          document.getElementById("saldo").innerText = "Rp 0";
          return;
        }
        const data = doc.data();
        document.getElementById("nama").innerText = data.nama;
        document.getElementById("saldo").innerText =
          "Rp " + data.saldo.toLocaleString("id-ID");
      })
      .catch(err=>{
        alert(err.message);
      });
  }
});
</script>

</body>
</html>
